# Instruções de uso:
# 1. Abra o PowerShell com privilégios administrativos.
# 2. Copie e cole este script no console do PowerShell.
# 3. Pressione Enter para executar.

# Definir o diretório
$strDir = "C:\temp\test1\"

# Remover todos os itens no diretório
Get-ChildItem $strDir | Remove-Item -Force

# Criar 200 arquivos de texto com conteúdo "something"
1..200 | ForEach-Object {
    $strPath = "$strDir$_" + ".txt"
    "something" | Out-File -FilePath $strPath -Encoding ASCII -Force
}

# Medir o tempo de execução de adicionar texto e renomear arquivos
Measure-Command {
    1..101 | ForEach-Object {
        $strPath = "$strDir$_" + ".txt"
        $strNewPath = "$strPath" + ".chng"
        "changed" | Out-File -Append -FilePath $strPath -Encoding ASCII
        Rename-Item -Path $strPath -NewName $strNewPath
    }
}
